!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function n(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?t(Object(r),!0).forEach((function(t){f(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,d(r.key),r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function a(){return a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=s(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},a.apply(this,arguments)}function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}function u(t){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=s(t);if(n){var i=s(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return function(t,n){if(n&&("object"===e(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return l(t)}(this,r)}}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function f(e,t,n){return(t=d(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(t){var n=function(t,n){if("object"!==e(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,n||"default");if("object"!==e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"===e(n)?n:String(n)}function p(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */p=function(){return n};var t,n={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(t){s=function(e,t,n){return e[t]=n}}function f(e,t,n,r){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),c=new k(r||[]);return i(a,"_invoke",{value:_(e,n,c)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}n.wrap=f;var h="suspendedStart",v="suspendedYield",y="executing",m="completed",b={};function g(){}function O(){}function w(){}var E={};s(E,c,(function(){return this}));var P=Object.getPrototypeOf,I=P&&P(P(D([])));I&&I!==r&&o.call(I,c)&&(E=I);var L=w.prototype=g.prototype=Object.create(E);function N(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function T(t,n){function r(i,a,c,u){var l=d(t[i],t,a);if("throw"!==l.type){var s=l.arg,f=s.value;return f&&"object"==e(f)&&o.call(f,"__await")?n.resolve(f.__await).then((function(e){r("next",e,c,u)}),(function(e){r("throw",e,c,u)})):n.resolve(f).then((function(e){s.value=e,c(s)}),(function(e){return r("throw",e,c,u)}))}u(l.arg)}var a;i(this,"_invoke",{value:function(e,t){function o(){return new n((function(n,o){r(e,t,n,o)}))}return a=a?a.then(o,o):o()}})}function _(e,n,r){var o=h;return function(i,a){if(o===y)throw new Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var u=S(c,r);if(u){if(u===b)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===h)throw o=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=y;var l=d(e,n,r);if("normal"===l.type){if(o=r.done?m:v,l.arg===b)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o=m,r.method="throw",r.arg=l.arg)}}}function S(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,S(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),b;var i=d(o,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,b;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,b):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,b)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function D(n){if(n||""===n){var r=n[c];if(r)return r.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var i=-1,a=function e(){for(;++i<n.length;)if(o.call(n,i))return e.value=n[i],e.done=!1,e;return e.value=t,e.done=!0,e};return a.next=a}}throw new TypeError(e(n)+" is not iterable")}return O.prototype=w,i(L,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:O,configurable:!0}),O.displayName=s(w,l,"GeneratorFunction"),n.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===O||"GeneratorFunction"===(t.displayName||t.name))},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,s(e,l,"GeneratorFunction")),e.prototype=Object.create(L),e},n.awrap=function(e){return{__await:e}},N(T.prototype),s(T.prototype,u,(function(){return this})),n.AsyncIterator=T,n.async=function(e,t,r,o,i){void 0===i&&(i=Promise);var a=new T(f(e,t,r,o),i);return n.isGeneratorFunction(t)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},N(L),s(L,l,"Generator"),s(L,c,(function(){return this})),s(L,"toString",(function(){return"[object Generator]"})),n.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},n.values=D,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(j),!e)for(var n in this)"t"===n.charAt(0)&&o.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(r,o){return c.type="throw",c.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var u=o.call(a,"catchLoc"),l=o.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),b},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),j(n),b}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;j(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:D(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),b}},n}function h(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(l){return void n(l)}c.done?t(u):Promise.resolve(u).then(r,o)}function v(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){h(i,r,o,a,c,"next",e)}function c(e){h(i,r,o,a,c,"throw",e)}a(void 0)}))}}System.register(["@ibiz-template/runtime","vue","@ibiz-template/vue3-util","qx-util"],(function(e,t){"use strict";var o,d,h,y,m,b,g,O,w,E,P,I,L,N,T,_,S;return{setters:[function(e){o=e.ValueOP,d=e.getEditorProvider,h=e.CodeListEditorController,y=e.getEntitySchema,m=e.registerEditorProvider},function(e){b=e.defineComponent,g=e.ref,O=e.watch,w=e.createVNode,E=e.createTextVNode,P=e.resolveComponent,I=e.isVNode,L=e.h},function(e){N=e.getInputProps,T=e.getEditorEmits,_=e.useNamespace},function(e){S=e.createUUID}],execute:function(){var t={string:[o.EQ,o.NOT_EQ,o.IS_NULL,o.IS_NOT_NULL,o.USER_LIKE,o.LIKE,o.LIFT_LIKE,o.RIGHT_LIKE],number:[o.EQ,o.GT,o.GT_AND_EQ,o.LT,o.LT_AND_EQ,o.NOT_EQ,o.IS_NULL,o.IS_NOT_NULL,o.IN,o.NOT_IN],date:[o.EQ,o.GT,o.GT_AND_EQ,o.LT,o.LT_AND_EQ,o.NOT_EQ,o.IS_NULL,o.IS_NOT_NULL,o.IN,o.NOT_IN],dropdown:[o.EQ,o.NOT_EQ,o.IS_NULL,o.IS_NOT_NULL,o.IN,o.NOT_IN],dataPicker:[o.EQ,o.NOT_EQ,o.IS_NULL,o.IS_NOT_NULL,o.IN,o.NOT_IN]},x=[o.IS_NULL,o.IS_NOT_NULL,o.EXISTS,o.NOT_EXISTS],j={string:{appId:"",editorType:"TEXTBOX"},number:{appId:"",editorType:"NUMBER"},date:{appId:"",editorType:"DATEPICKEREX",dateTimeFormat:"YYYY-MM-DD"},dropdown:{appId:"",valueType:"SIMPLE",editorType:"MDROPDOWNLIST",appCodeListId:"",editorParams:{overflowMode:"ellipsis"}},dataPicker:{appId:"",editorType:"ADDRESSPICKUP",appDEDataSetId:"fetchdefault",objectIdField:"srfkey",objectNameField:"srfmajortext",valueType:"OBJECTS",editorParams:{overflowMode:"ellipsis"}}},k=[{valueOP:o.EQ,label:"等于(=)"},{valueOP:o.NOT_EQ,label:"不等于(<>)"},{valueOP:o.GT,label:"大于(>)"},{valueOP:o.GT_AND_EQ,label:"大于等于(>=)"},{valueOP:o.LT,label:"小于(<)"},{valueOP:o.LT_AND_EQ,label:"小于等于(<=)"},{valueOP:o.IS_NULL,label:"值为空(Nil)"},{valueOP:o.IS_NOT_NULL,label:"值不为空(NotNil)"},{valueOP:o.IN,label:"值在范围中(In)"},{valueOP:o.NOT_IN,label:"值不在范围中(NotIn)"},{valueOP:o.LIKE,label:"文本包含(%)"},{valueOP:o.LIFT_LIKE,label:"文本左包含(%#)"},{valueOP:o.RIGHT_LIKE,label:"文本右包含(#%)"},{valueOP:o.EXISTS,label:"存在(EXISTS)"},{valueOP:o.NOT_EXISTS,label:"不存在(NOTEXISTS)"}];function D(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!I(e)}var F=b({name:"IBizFilterCondition",props:N(),emits:T(),setup:function(e,t){var n=t.emit,r=_("filter-condition"),o=e.controller,i=g([]),a=g([{text:"且",value:"AND"},{text:"或",value:"OR"}]),c=new Map;k.forEach((function(e){return c.set(e.valueOP,e.label)}));var u=function(){var e=v(p().mark((function e(t){var n,r,i,a;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=o.schemaFieldMap.get(t.field)){e.next=3;break}return e.abrupt("return");case 3:return r=o.getEditor(n),e.next=6,d(r);case 6:if(!(i=e.sent)){e.next=13;break}return t.editorProvider=i,e.next=11,i.createController(r,{context:o.context,params:o.params});case 11:a=e.sent,t.editor=a;case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();O((function(){return e.value}),v(p().mark((function t(){var n,r,o;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.value){t.next=3;break}return i.value=[],t.abrupt("return");case 3:if("string"!=typeof e.value){t.next=12;break}if(n=JSON.parse(e.value),r=(null==n?void 0:n.condop)||"AND",o=(null==n?void 0:n.searchconds)||[],!Array.isArray(o)||!o.length){t.next=12;break}return t.next=10,Promise.all(o.map(function(){var e=v(p().mark((function e(t){var n,o,i,a;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.fieldname||"",o=t.condop||"",i=t.value,a={key:S(),connection:r,field:n,valueOP:o,value:i},e.next=6,u(a);case 6:return e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 10:return i.value=t.sent,t.abrupt("return");case 12:i.value=[];case 13:case"end":return t.stop()}}),t)}))),{immediate:!0});var l=function(){var e;if(i.value.length){var t={condop:(null===(e=i.value[0])||void 0===e?void 0:e.connection)||"AND",condtype:"GROUP",searchconds:[]};i.value.forEach((function(e){t.searchconds.push({condtype:"DEFIELD",fieldname:e.field,condop:e.valueOP,value:e.value})})),n("change",JSON.stringify(t))}else n("change","")},s=function(){var t=v(p().mark((function t(){var n,r,a,c,s,f;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.disabled){t.next=2;break}return t.abrupt("return");case 2:return a=i.value[0],c=(null===(n=o.schemaFields[0])||void 0===n?void 0:n.appDEFieldId)||"",s=(null===(r=o.schemaFieldMap.get(c))||void 0===r||null===(r=r.valueOPs)||void 0===r?void 0:r[0])||"",f={key:S(),connection:null!=a&&a.connection?a.connection:"AND",field:c,valueOP:s},t.next=8,u(f);case 8:i.value.push(f),l();case 10:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),f=function(){var e=v(p().mark((function e(t){var n,r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.schemaFieldMap.get(t.field),t.valueOP=(null==r||null===(n=r.valueOPs)||void 0===n?void 0:n[0])||"",t.value=void 0,t.editorProvider=void 0,t.editor=void 0,e.next=7,u(t);case 7:l();case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{ns:r,c:o,items:i,connectionItems:a,filterModeMap:c,handleAdd:s,handleRemove:function(t){e.disabled||(i.value.splice(t,1),l())},renderEditor:function(t){if(!t.valueOP||x.includes(t.valueOP))return null;if(t.editorProvider&&t.editor){var n=P(t.editorProvider.formEditor);return L(n,{value:t.value,controller:t.editor,disabled:e.disabled,onChange:function(e){t.value=e,l()}})}},handleConnectionChange:function(e){i.value.forEach((function(t){t.connection=e.connection})),l()},handleFieldChange:f,handleValueOPChange:function(e){e.value=void 0,l()}}},render:function(){var e=this;return w("div",{class:[this.ns.b(),this.disabled&&this.ns.m("disabled")]},[w("div",{class:this.ns.b("content")},[this.items.map((function(t,n){var r,o;return w("div",{class:e.ns.b("item")},[w("div",{class:[e.ns.be("item","connection"),0===n&&e.ns.bem("item","connection","init")]},[0===n?w("div",null,[E("当")]):w(P("el-select"),{modelValue:t.connection,"onUpdate:modelValue":function(e){return t.connection=e},disabled:n>1||e.disabled,onChange:function(){e.handleConnectionChange(t)}},D(r=e.connectionItems.map((function(e){return w(P("el-option"),{key:e.value,value:e.value,label:e.text},null)})))?r:{default:function(){return[r]}})]),w("div",{class:e.ns.b("item-content")},[w("div",{class:e.ns.be("item","field")},[w(P("el-select"),{modelValue:t.field,"onUpdate:modelValue":function(e){return t.field=e},disabled:e.disabled,onChange:function(){e.handleFieldChange(t)}},D(o=e.c.schemaFields.map((function(e){return w(P("el-option"),{key:e.appDEFieldId,value:e.appDEFieldId,label:e.caption},null)})))?o:{default:function(){return[o]}})]),w("div",{class:e.ns.be("item","valueOP")},[w(P("el-select"),{modelValue:t.valueOP,"onUpdate:modelValue":function(e){return t.valueOP=e},disabled:e.disabled,onChange:function(){e.handleValueOPChange(t)}},{default:function(){var n;return[null===(n=e.c.schemaFieldMap.get(t.field))||void 0===n||null===(n=n.valueOPs)||void 0===n?void 0:n.map((function(t){return w(P("el-option"),{key:t,value:t,label:e.filterModeMap.get(t)||t},null)}))]}})]),w("div",{class:e.ns.be("item","editor")},[e.renderEditor(t)])]),w("div",{class:e.ns.be("item","btn"),onClick:function(t){t.stopPropagation(),e.handleRemove(n)}},[w("svg",{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",height:"1em",width:"1em",preserveAspectRatio:"xMidYMid meet",focusable:"false"},[w("g",{"stroke-width":"1","fill-rule":"evenodd"},[w("path",{d:"M4.002 3.403V1a1 1 0 0 1 1-1h6.003a1 1 0 0 1 1 1v2.403h3.396a.6.6 0 1 1 0 1.2h-1.395V15a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V4.603H.6a.6.6 0 1 1 0-1.2h3.4zm8.804 1.205H3.2V14.8h9.605V4.608zM5.202 1.2v2.155h5.603V1.2H5.202zm.6 6.417a.6.6 0 0 1 1.201 0v4.758a.6.6 0 0 1-1.2 0V7.617zm3.202 0a.6.6 0 0 1 1.2 0v4.758a.6.6 0 0 1-1.2 0V7.617z"},null)])])])])}))]),w("div",{class:this.ns.b("footer")},[w("div",{class:this.ns.b("footer-btn"),onClick:this.handleAdd},[w("svg",{class:this.ns.be("footer-btn","icon"),viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",height:"1em",width:"1em",preserveAspectRatio:"xMidYMid meet",focusable:"false"},[w("g",{"stroke-width":"1","fill-rule":"evenodd"},[w("path",{d:"M8.578 7.383V1.602a.601.601 0 1 0-1.2 0v5.781H1.6a.601.601 0 0 0 0 1.203h5.777v5.812a.601.601 0 1 0 1.2 0V8.586H14.4a.601.601 0 0 0 0-1.203H8.578z"},null)])]),w("div",{class:this.ns.be("footer-btn","text")},[E("新增筛选条件")])])])])}}),C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(h,e);var o,d=u(h);function h(){var e;r(this,h);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return f(l(e=d.call.apply(d,[this].concat(n))),"jsonSchemaTag",""),f(l(e),"schemaFields",[]),f(l(e),"schemaFieldMap",new Map),e}return i(h,[{key:"onInit",value:(o=v(p().mark((function e(){var t,r,o,i=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a(s(h.prototype),"onInit",this).call(this);case 2:if(this.jsonSchemaTag=(null===(t=this.editorParams)||void 0===t?void 0:t.JSONSCHEMATAG)||"",!this.jsonSchemaTag){e.next=8;break}return e.next=6,y(this.jsonSchemaTag,this.context,n({},this.params));case 6:(r=e.sent)&&(o=this.calcSchemaFieldBySchema(r),this.schemaFields=o,this.schemaFields.forEach((function(e){i.schemaFieldMap.set(e.appDEFieldId,e)})));case 8:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"calcSchemaFieldBySchema",value:function(e){if(!e.properties)return[];var n=e.properties;if(!Object.keys(n).length)return[];var r=[];return Object.keys(n).forEach((function(e){var o,i="string";switch(n[e].type){case"string":"date-time"===n[e].format&&(i="date"),n[e].enumSource&&(i="dropdown");break;case"integer":case"number":i="number";break;default:n[e].$ref&&(i="dataPicker")}r.push({type:i,appDEFieldId:e,valueOPs:t[i],caption:n[e].description,appDataEntityId:null===(o=n[e].$ref)||void 0===o?void 0:o.split(".")[0],appCodeListId:n[e].enumSource})})),r}},{key:"getEditor",value:function(e){var t=n({},j[e.type]);return"dropdown"===e.type&&Object.assign(t,{appCodeListId:e.appCodeListId}),"dataPicker"===e.type&&Object.assign(t,{appDataEntityId:e.appDataEntityId}),t}}]),h}(h),M=function(){function e(){r(this,e),f(this,"formEditor","IBizFilterCondition"),f(this,"gridEditor","IBizFilterCondition")}var t;return i(e,[{key:"createController",value:(t=v(p().mark((function e(t,n){var r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new C(t,n),e.next=3,r.init();case 3:return e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)}))),function(e,n){return t.apply(this,arguments)})}]),e}();e("default",{install:function(e){e.component(F.name,F),m("EDITOR_CUSTOMSTYLE_FILTER_CONDITION",(function(){return new M}))}})}}}))}();
